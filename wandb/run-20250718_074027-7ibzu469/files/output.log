LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/opt/conda/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

  | Name  | Type | Params | Mode
---------------------------------------
0 | model | E2E  | 238 M  | train
---------------------------------------
238 M     Trainable params
0         Non-trainable params
238 M     Total params
955.192   Total estimated model params size (MB)
561       Modules in train mode
0         Modules in eval mode
Sanity Checking DataLoader 0:   0%|                                                                                                  | 0/2 [00:00<?, ?it/s]Sample 0: Processing target shape torch.Size([17])
Sample 0: Encoded features shape: torch.Size([96, 768])
Error processing sample 0: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 1: Processing target shape torch.Size([17])
Sample 1: Encoded features shape: torch.Size([96, 768])
Error processing sample 1: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 2: Processing target shape torch.Size([17])
Sample 2: Encoded features shape: torch.Size([96, 768])
Error processing sample 2: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 3: Processing target shape torch.Size([17])
Sample 3: Encoded features shape: torch.Size([96, 768])
Error processing sample 3: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 4: Processing target shape torch.Size([17])
Sample 4: Encoded features shape: torch.Size([96, 768])
Error processing sample 4: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 5: Processing target shape torch.Size([17])
Sample 5: Encoded features shape: torch.Size([96, 768])
Error processing sample 5: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 6: Processing target shape torch.Size([17])
Sample 6: Encoded features shape: torch.Size([96, 768])
Error processing sample 6: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 7: Processing target shape torch.Size([17])
Sample 7: Encoded features shape: torch.Size([96, 768])
Error processing sample 7: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 8: Processing target shape torch.Size([17])
Sample 8: Encoded features shape: torch.Size([96, 768])
Error processing sample 8: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 9: Processing target shape torch.Size([17])
Sample 9: Encoded features shape: torch.Size([96, 768])
Error processing sample 9: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 10: Processing target shape torch.Size([17])
Sample 10: Encoded features shape: torch.Size([96, 768])
Error processing sample 10: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([96, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sanity Checking DataLoader 0:  50%|█████████████████████████████████████████████                                             | 1/2 [00:01<00:01,  0.90it/s]Sample 0: Processing target shape torch.Size([17])
Sample 0: Encoded features shape: torch.Size([89, 768])
Error processing sample 0: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 1: Processing target shape torch.Size([17])
Sample 1: Encoded features shape: torch.Size([89, 768])
Error processing sample 1: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 2: Processing target shape torch.Size([17])
Sample 2: Encoded features shape: torch.Size([89, 768])
Error processing sample 2: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 3: Processing target shape torch.Size([17])
Sample 3: Encoded features shape: torch.Size([89, 768])
Error processing sample 3: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 4: Processing target shape torch.Size([17])
Sample 4: Encoded features shape: torch.Size([89, 768])
Error processing sample 4: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 5: Processing target shape torch.Size([17])
Sample 5: Encoded features shape: torch.Size([89, 768])
Error processing sample 5: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 6: Processing target shape torch.Size([17])
Sample 6: Encoded features shape: torch.Size([89, 768])
Error processing sample 6: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 7: Processing target shape torch.Size([17])
Sample 7: Encoded features shape: torch.Size([89, 768])
Error processing sample 7: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 8: Processing target shape torch.Size([17])
Sample 8: Encoded features shape: torch.Size([89, 768])
Error processing sample 8: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 9: Processing target shape torch.Size([17])
Sample 9: Encoded features shape: torch.Size([89, 768])
Error processing sample 9: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Sample 10: Processing target shape torch.Size([17])
Sample 10: Encoded features shape: torch.Size([89, 768])
Error processing sample 10: selected index k out of range
Target shape: torch.Size([1, 17])
Input shape: torch.Size([89, 1, 88, 88])
Traceback (most recent call last):
  File "/workspace/auto-avsr/lightning.py", line 131, in _calculate_wer_for_batch
    nbest_hyps = self.beam_search(enc_feat)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/auto-avsr/espnet/nets/beam_search.py", line 365, in forward
    best = self.search(running_hyps, x)
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 257, in search
    ) in zip(*self.batch_beam(weighted_scores, part_ids)):
  File "/workspace/auto-avsr/espnet/nets/batch_beam_search.py", line 104, in batch_beam
    top_ids = weighted_scores.view(-1).topk(self.beam_size)[1]
RuntimeError: selected index k out of range
Epoch 0:   0%|                                                                                                                      | 0/59 [00:00<?, ?it/s]

Detected KeyboardInterrupt, attempting graceful shutdown ...
